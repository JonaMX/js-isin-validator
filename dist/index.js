'use strict';

function _slicedToArray(r, e) { return _arrayWithHoles(r) || _iterableToArrayLimit(r, e) || _unsupportedIterableToArray(r, e) || _nonIterableRest(); }
function _nonIterableRest() { throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method."); }
function _unsupportedIterableToArray(r, a) { if (r) { if ("string" == typeof r) return _arrayLikeToArray(r, a); var t = {}.toString.call(r).slice(8, -1); return "Object" === t && r.constructor && (t = r.constructor.name), "Map" === t || "Set" === t ? Array.from(r) : "Arguments" === t || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t) ? _arrayLikeToArray(r, a) : void 0; } }
function _arrayLikeToArray(r, a) { (null == a || a > r.length) && (a = r.length); for (var e = 0, n = Array(a); e < a; e++) n[e] = r[e]; return n; }
function _iterableToArrayLimit(r, l) { var t = null == r ? null : "undefined" != typeof Symbol && r[Symbol.iterator] || r["@@iterator"]; if (null != t) { var e, n, i, u, a = [], f = !0, o = !1; try { if (i = (t = t.call(r)).next, 0 === l) { if (Object(t) !== t) return; f = !1; } else for (; !(f = (e = i.call(t)).done) && (a.push(e.value), a.length !== l); f = !0); } catch (r) { o = !0, n = r; } finally { try { if (!f && null != t["return"] && (u = t["return"](), Object(u) !== u)) return; } finally { if (o) throw n; } } return a; } }
function _arrayWithHoles(r) { if (Array.isArray(r)) return r; }
var R = require('ramda');
var countries = require('../data/countries.json');
var getAsciiCode = R.invoker(0, 'charCodeAt');
var isinRegex = /^([a-zA-Z]{2})((?![a-zA-Z]{10}\b)[a-zA-Z0-9]{9})([0-9])$/;
var calcIsinCheckDigit = function calcIsinCheckDigit(isin) {
  var _R$splitAt = R.splitAt(-1, isin),
    _R$splitAt2 = _slicedToArray(_R$splitAt, 1),
    code = _R$splitAt2[0];
  // Convert any alphabetic letters to their numeric equivalents
  var digest = R.compose(R.join(''), R.map(function (d) {
    return R.compose(R.ifElse(R.flip(R.gt)(57), R.flip(R.subtract)(55), R.always(d)), getAsciiCode)(d);
  }))(code);

  // Beginning with the least significant digit (on the right), multiply every other digit by 2.
  var digitsTimesTwo = R.compose(R.join(''), R.addIndex(R.map)(function (val, idx) {
    return R.ifElse(R.compose(R.not, R.modulo(R.__, 2)), R.always(R.compose(R.multiply(2), parseInt)(val)), R.always(val))(idx);
  }), R.reverse)(digest);
  // Add up the resulting digits, calling the result SUM.
  var sum = R.compose(R.sum, R.map(parseInt))(digitsTimesTwo);
  // Find the smallest number ending with a zero that is greater than or equal to SUM, and call it VALUE.
  // Subtract SUM from VALUE, giving the check digit.
  return (10 - sum % 10) % 10;
};
var isIsinValid = function isIsinValid(isin) {
  if (!R.test(isinRegex)(isin)) {
    return false;
  }
  var countryCode = R.take(2, isin);
  if (!R.find(R.propEq(countryCode, 'code'))(countries)) {
    return false;
  }
  var checkDigit = R.compose(parseInt, R.takeLast(1))(isin);
  return R.compose(R.equals(checkDigit), calcIsinCheckDigit)(isin);
};
module.exports = {
  countries: countries,
  isinRegex: isinRegex,
  calcIsinCheckDigit: R.compose(calcIsinCheckDigit, R.toUpper),
  isIsinValid: R.compose(isIsinValid, R.toUpper)
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfc2xpY2VkVG9BcnJheSIsInIiLCJlIiwiX2FycmF5V2l0aEhvbGVzIiwiX2l0ZXJhYmxlVG9BcnJheUxpbWl0IiwiX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5IiwiX25vbkl0ZXJhYmxlUmVzdCIsIlR5cGVFcnJvciIsImEiLCJfYXJyYXlMaWtlVG9BcnJheSIsInQiLCJ0b1N0cmluZyIsImNhbGwiLCJzbGljZSIsImNvbnN0cnVjdG9yIiwibmFtZSIsIkFycmF5IiwiZnJvbSIsInRlc3QiLCJsZW5ndGgiLCJuIiwibCIsIlN5bWJvbCIsIml0ZXJhdG9yIiwiaSIsInUiLCJmIiwibyIsIm5leHQiLCJPYmplY3QiLCJkb25lIiwicHVzaCIsInZhbHVlIiwiaXNBcnJheSIsIlIiLCJyZXF1aXJlIiwiY291bnRyaWVzIiwiZ2V0QXNjaWlDb2RlIiwiaW52b2tlciIsImlzaW5SZWdleCIsImNhbGNJc2luQ2hlY2tEaWdpdCIsImlzaW4iLCJfUiRzcGxpdEF0Iiwic3BsaXRBdCIsIl9SJHNwbGl0QXQyIiwiY29kZSIsImRpZ2VzdCIsImNvbXBvc2UiLCJqb2luIiwibWFwIiwiZCIsImlmRWxzZSIsImZsaXAiLCJndCIsInN1YnRyYWN0IiwiYWx3YXlzIiwiZGlnaXRzVGltZXNUd28iLCJhZGRJbmRleCIsInZhbCIsImlkeCIsIm5vdCIsIm1vZHVsbyIsIl9fIiwibXVsdGlwbHkiLCJwYXJzZUludCIsInJldmVyc2UiLCJzdW0iLCJpc0lzaW5WYWxpZCIsImNvdW50cnlDb2RlIiwidGFrZSIsImZpbmQiLCJwcm9wRXEiLCJjaGVja0RpZ2l0IiwidGFrZUxhc3QiLCJlcXVhbHMiLCJtb2R1bGUiLCJleHBvcnRzIiwidG9VcHBlciJdLCJzb3VyY2VzIjpbIi4uL2xpYi9pbmRleC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbmNvbnN0IFIgICAgICAgICA9IHJlcXVpcmUoJ3JhbWRhJyk7XG5jb25zdCBjb3VudHJpZXMgPSByZXF1aXJlKCcuLi9kYXRhL2NvdW50cmllcy5qc29uJyk7XG5cbmNvbnN0IGdldEFzY2lpQ29kZSA9IFIuaW52b2tlcigwLCAnY2hhckNvZGVBdCcpO1xuY29uc3QgaXNpblJlZ2V4ICAgID0gL14oW2EtekEtWl17Mn0pKCg/IVthLXpBLVpdezEwfVxcYilbYS16QS1aMC05XXs5fSkoWzAtOV0pJC87XG5cbmNvbnN0IGNhbGNJc2luQ2hlY2tEaWdpdCA9IGlzaW4gPT4ge1xuICBjb25zdCBbY29kZV0gPSBSLnNwbGl0QXQoLTEsIGlzaW4pO1xuICAvLyBDb252ZXJ0IGFueSBhbHBoYWJldGljIGxldHRlcnMgdG8gdGhlaXIgbnVtZXJpYyBlcXVpdmFsZW50c1xuICBjb25zdCBkaWdlc3QgPSBSLmNvbXBvc2UoXG4gICAgUi5qb2luKCcnKSxcbiAgICBSLm1hcCggZCA9PlxuICAgICAgUi5jb21wb3NlKFxuICAgICAgICBSLmlmRWxzZShcbiAgICAgICAgICBSLmZsaXAoUi5ndCkoNTcpLFxuICAgICAgICAgIFIuZmxpcChSLnN1YnRyYWN0KSg1NSksXG4gICAgICAgICAgUi5hbHdheXMoZClcbiAgICAgICAgKSxcbiAgICAgICAgZ2V0QXNjaWlDb2RlXG4gICAgICApKGQpXG4gICAgKVxuICApKGNvZGUpO1xuXG4gIC8vIEJlZ2lubmluZyB3aXRoIHRoZSBsZWFzdCBzaWduaWZpY2FudCBkaWdpdCAob24gdGhlIHJpZ2h0KSwgbXVsdGlwbHkgZXZlcnkgb3RoZXIgZGlnaXQgYnkgMi5cbiAgY29uc3QgZGlnaXRzVGltZXNUd28gPSBSLmNvbXBvc2UoXG4gICAgUi5qb2luKCcnKSxcbiAgICBSLmFkZEluZGV4KFIubWFwKSgodmFsLCBpZHgpID0+IFIuaWZFbHNlKFxuICAgICAgUi5jb21wb3NlKFIubm90LCBSLm1vZHVsbyhSLl9fLCAyKSksXG4gICAgICBSLmFsd2F5cyhSLmNvbXBvc2UoUi5tdWx0aXBseSgyKSxwYXJzZUludCkodmFsKSksXG4gICAgICBSLmFsd2F5cyh2YWwpXG4gICAgKShpZHgpKSxcbiAgICBSLnJldmVyc2VcbiAgKShkaWdlc3QpO1xuICAvLyBBZGQgdXAgdGhlIHJlc3VsdGluZyBkaWdpdHMsIGNhbGxpbmcgdGhlIHJlc3VsdCBTVU0uXG4gIGNvbnN0IHN1bSA9IFIuY29tcG9zZShSLnN1bSwgUi5tYXAocGFyc2VJbnQpKShkaWdpdHNUaW1lc1R3byk7XG4gIC8vIEZpbmQgdGhlIHNtYWxsZXN0IG51bWJlciBlbmRpbmcgd2l0aCBhIHplcm8gdGhhdCBpcyBncmVhdGVyIHRoYW4gb3IgZXF1YWwgdG8gU1VNLCBhbmQgY2FsbCBpdCBWQUxVRS5cbiAgLy8gU3VidHJhY3QgU1VNIGZyb20gVkFMVUUsIGdpdmluZyB0aGUgY2hlY2sgZGlnaXQuXG4gIHJldHVybiAoMTAgLSAoc3VtICUgMTApKSAlIDEwO1xufTtcblxuY29uc3QgaXNJc2luVmFsaWQgPSBpc2luID0+IHtcbiAgaWYgKCFSLnRlc3QoaXNpblJlZ2V4KShpc2luKSkgeyByZXR1cm4gZmFsc2U7IH1cblxuICBjb25zdCBjb3VudHJ5Q29kZSA9IFIudGFrZSgyLCBpc2luKTtcbiAgaWYgKCFSLmZpbmQoUi5wcm9wRXEoY291bnRyeUNvZGUsICdjb2RlJykpKGNvdW50cmllcykpIHsgcmV0dXJuIGZhbHNlOyB9XG5cbiAgY29uc3QgY2hlY2tEaWdpdCA9IFIuY29tcG9zZShwYXJzZUludCwgUi50YWtlTGFzdCgxKSkoaXNpbik7XG4gIHJldHVybiBSLmNvbXBvc2UoUi5lcXVhbHMoY2hlY2tEaWdpdCksIGNhbGNJc2luQ2hlY2tEaWdpdCkoaXNpbik7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgY291bnRyaWVzLFxuICBpc2luUmVnZXgsXG4gIGNhbGNJc2luQ2hlY2tEaWdpdCA6IFIuY29tcG9zZShjYWxjSXNpbkNoZWNrRGlnaXQsIFIudG9VcHBlciksXG4gIGlzSXNpblZhbGlkICAgICAgICA6IFIuY29tcG9zZShpc0lzaW5WYWxpZCwgUi50b1VwcGVyKVxufTtcbiJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWTs7QUFB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QyxFQUNoRHhCLENBQUMsQ0FBQ3FCLE1BQU0sQ0FBQ0csR0FBRyxDQUNkLENBQUMsQ0FBQ0MsR0FBRyxDQUFDO0VBQUEsRUFBQyxFQUNQekIsQ0FBQyxDQUFDK0IsT0FDSixDQUFDLENBQUNuQixNQUFNLENBQUM7RUFDVDtFQUNBLElBQU1vQixHQUFHLEdBQUdoQyxDQUFDLENBQUNhLE9BQU8sQ0FBQ2IsQ0FBQyxDQUFDZ0MsR0FBRyxFQUFFaEMsQ0FBQyxDQUFDZSxHQUFHLENBQUNlLFFBQVEsQ0FBQyxDQUFDLENBQUNSLGNBQWMsQ0FBQztFQUM3RDtFQUNBO0VBQ0EsT0FBTyxDQUFDLEVBQUUsR0FBSVUsR0FBRyxHQUFHLEVBQUcsSUFBSSxFQUFFO0FBQy9CLENBQUM7QUFFRCxJQUFNQyxXQUFXLEdBQUcsU0FBZEEsV0FBV0EsQ0FBRzFCLElBQUksRUFBSTtFQUMxQixJQUFJLENBQUNQLENBQUMsQ0FBQ2hCLElBQUksQ0FBQ3FCLFNBQVMsQ0FBQyxDQUFDRSxJQUFJLENBQUMsRUFBRTtJQUFFLE9BQU8sS0FBSztFQUFFO0VBRTlDLElBQU0yQixXQUFXLEdBQUdsQyxDQUFDLENBQUNtQyxJQUFJLENBQUMsQ0FBQyxFQUFFNUIsSUFBSSxDQUFDO0VBQ25DLElBQUksQ0FBQ1AsQ0FBQyxDQUFDb0MsSUFBSSxDQUFDcEMsQ0FBQyxDQUFDcUMsTUFBTSxDQUFDSCxXQUFXLEVBQUUsTUFBTSxDQUFDLENBQUMsQ0FBQ2hDLFNBQVMsQ0FBQyxFQUFFO0lBQUUsT0FBTyxLQUFLO0VBQUU7RUFFdkUsSUFBTW9DLFVBQVUsR0FBR3RDLENBQUMsQ0FBQ2EsT0FBTyxDQUFDaUIsUUFBUSxFQUFFOUIsQ0FBQyxDQUFDdUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUNoQyxJQUFJLENBQUM7RUFDM0QsT0FBT1AsQ0FBQyxDQUFDYSxPQUFPLENBQUNiLENBQUMsQ0FBQ3dDLE1BQU0sQ0FBQ0YsVUFBVSxDQUFDLEVBQUVoQyxrQkFBa0IsQ0FBQyxDQUFDQyxJQUFJLENBQUM7QUFDbEUsQ0FBQztBQUVEa0MsTUFBTSxDQUFDQyxPQUFPLEdBQUc7RUFDZnhDLFNBQVMsRUFBVEEsU0FBUztFQUNURyxTQUFTLEVBQVRBLFNBQVM7RUFDVEMsa0JBQWtCLEVBQUdOLENBQUMsQ0FBQ2EsT0FBTyxDQUFDUCxrQkFBa0IsRUFBRU4sQ0FBQyxDQUFDMkMsT0FBTyxDQUFDO0VBQzdEVixXQUFXLEVBQVVqQyxDQUFDLENBQUNhLE9BQU8sQ0FBQ29CLFdBQVcsRUFBRWpDLENBQUMsQ0FBQzJDLE9BQU87QUFDdkQsQ0FBQyIsImlnbm9yZUxpc3QiOltdfQ==